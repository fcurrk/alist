import{V as m,f as e,a4 as L,Q as I,A as j,q as o,bo as M,a as O,b8 as U,u as V,a2 as q,bg as g,af as D,x as E,I as p,bp as F,a7 as H,B as d,bk as k,bq as v,a_ as K,a$ as N,an as P,h as W,n as x}from"./index.a7922b43.js";import{u as A}from"./useT.5d10c686.js";import{a as Q}from"./useTitle.4dce140a.js";const G=()=>{const n=m("#f1f3f5","#666666");return e(L,{get bgColor(){return n()},pos:"fixed",top:"0",left:"0",overflow:"hidden",zIndex:"-1",w:"100vw",h:"100vh"})},Z=()=>{const n=I("logo").split(`
`);m(n[0],n.pop());const r=A(),h=j(()=>`${r("login.login_to")} ${I("site_title")}`);Q(h);const y=m("white","$neutral1"),[a,f]=o(localStorage.getItem("username")||""),[s,w]=o(localStorage.getItem("password")||""),[$,C]=o(""),[l,T]=M("remember-pwd","false"),[_,R]=O(()=>U.post("/auth/login",{username:a(),password:s(),otp_code:$()})),{searchParams:S,to:b}=V(),c=async()=>{l()==="true"?(localStorage.setItem("username",a()),localStorage.setItem("password",s())):(localStorage.removeItem("username"),localStorage.removeItem("password"));const t=await R();W(t,i=>{x.success(r("login.success")),k(i.token),b(decodeURIComponent(S.redirect||v||"/"),!0)},(i,B)=>{!u()&&B===402?z(!0):x.error(i)})},[u,z]=o(!1);return e(P,{zIndex:"1",w:"$full",h:"100vh",get children(){return[e(q,{get bgColor(){return y()},rounded:"$xl",p:"24px",w:{"@initial":"90%","@sm":"364px"},spacing:"$4",get children(){return[e(g,{alignItems:"center",justifyContent:"space-around",get children(){return e(D,{color:"$info9",fontSize:"$2xl",get children(){return h()}})}}),e(E,{get when(){return!u()},get fallback(){return e(p,{id:"totp",name:"otp",get placeholder(){return r("login.otp-tips")},get value(){return $()},onChange:t=>C(t.currentTarget.value),onKeyDown:t=>{t.key==="Enter"&&c()}})},get children(){return[e(p,{name:"username",get placeholder(){return r("login.username-tips")},get value(){return a()},onInput:t=>f(t.currentTarget.value)}),e(p,{name:"password",get placeholder(){return r("login.password-tips")},type:"password",get value(){return s()},onInput:t=>w(t.currentTarget.value),onKeyDown:t=>{t.key==="Enter"&&c()}}),e(g,{px:"$1",w:"$full",fontSize:"$sm",color:"$neutral10",justifyContent:"space-between",alignItems:"center",get children(){return e(F,{get checked(){return l()==="true"},onChange:()=>T(l()==="true"?"false":"true"),get children(){return r("login.remember")}})}})]}}),e(H,{w:"$full",spacing:"$2",get children(){return[e(d,{colorScheme:"primary",w:"$full",onClick:()=>{u()?C(""):(f(""),w(""))},get children(){return r("login.clear")}}),e(d,{w:"$full",get loading(){return _()},onClick:c,get children(){return r("login.login")}})]}}),e(d,{w:"$full",colorScheme:"accent",onClick:()=>{k(),b(decodeURIComponent(S.redirect||v||"/"),!0)},get children(){return r("login.use_guest")}}),e(g,{mt:"$2",justifyContent:"space-evenly",alignItems:"center",color:"$neutral10",w:"$full",get children(){return[e(K,{}),e(N,{})]}})]}}),e(G,{})]}})};export{Z as default};
