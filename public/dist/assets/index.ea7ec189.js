import{W as m,f as e,a5 as B,R as b,C as L,q as o,bo as j,a as M,b7 as O,u as U,a3 as W,bg as g,ag as D,x as E,I as p,bp as F,a8 as H,B as d,bk as k,aZ as K,a_ as N,al as P,h as V,n as v}from"./index.a945b89f.js";import{u as q}from"./useT.a0e20bac.js";import{a as Z}from"./useTitle.7b8c78be.js";const A=()=>{const n=m("#f1f3f5","#666666");return e(B,{get bgColor(){return n()},pos:"fixed",top:"0",left:"0",overflow:"hidden",zIndex:"-1",w:"100vw",h:"100vh"})},X=()=>{const n=b("logo").split(`
`);m(n[0],n.pop());const r=q(),h=L(()=>`${r("login.login_to")} ${b("site_title")}`);Z(h);const x=m("white","$neutral1"),[a,f]=o(localStorage.getItem("username")||""),[s,w]=o(localStorage.getItem("password")||""),[C,$]=o(""),[l,y]=j("remember-pwd","false"),[R,T]=M(()=>O.post("/auth/login",{username:a(),password:s(),otp_code:C()})),{searchParams:S,to:I}=U(),c=async()=>{l()==="true"?(localStorage.setItem("username",a()),localStorage.setItem("password",s())):(localStorage.removeItem("username"),localStorage.removeItem("password"));const t=await T();V(t,i=>{v.success(r("login.success")),k(i.token),I(decodeURIComponent(S.redirect||"/"),!0)},(i,z)=>{!u()&&z===402?_(!0):v.error(i)})},[u,_]=o(!1);return e(P,{zIndex:"1",w:"$full",h:"100vh",get children(){return[e(W,{get bgColor(){return x()},rounded:"$xl",p:"24px",w:{"@initial":"90%","@sm":"364px"},spacing:"$4",get children(){return[e(g,{alignItems:"center",justifyContent:"space-around",get children(){return e(D,{color:"$info9",fontSize:"$2xl",get children(){return h()}})}}),e(E,{get when(){return!u()},get fallback(){return e(p,{id:"totp",name:"otp",get placeholder(){return r("login.otp-tips")},get value(){return C()},onChange:t=>$(t.currentTarget.value),onKeyDown:t=>{t.key==="Enter"&&c()}})},get children(){return[e(p,{name:"username",get placeholder(){return r("login.username-tips")},get value(){return a()},onInput:t=>f(t.currentTarget.value)}),e(p,{name:"password",get placeholder(){return r("login.password-tips")},type:"password",get value(){return s()},onInput:t=>w(t.currentTarget.value),onKeyDown:t=>{t.key==="Enter"&&c()}}),e(g,{px:"$1",w:"$full",fontSize:"$sm",color:"$neutral10",justifyContent:"space-between",alignItems:"center",get children(){return e(F,{get checked(){return l()==="true"},onChange:()=>y(l()==="true"?"false":"true"),get children(){return r("login.remember")}})}})]}}),e(H,{w:"$full",spacing:"$2",get children(){return[e(d,{colorScheme:"primary",w:"$full",onClick:()=>{u()?$(""):(f(""),w(""))},get children(){return r("login.clear")}}),e(d,{w:"$full",get loading(){return R()},onClick:c,get children(){return r("login.login")}})]}}),e(d,{w:"$full",colorScheme:"accent",onClick:()=>{k(),I(decodeURIComponent(S.redirect||"/"),!0)},get children(){return r("login.use_guest")}}),e(g,{mt:"$2",justifyContent:"space-evenly",alignItems:"center",color:"$neutral10",w:"$full",get children(){return[e(K,{}),e(N,{})]}})]}}),e(A,{})]}})};export{X as default};
