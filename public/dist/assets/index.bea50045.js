import{W as I,f as e,a5 as R,q as n,bo as z,a as B,b7 as L,u as j,a3 as O,bg as i,ag as U,x as W,I as g,bp as _,a8 as D,B as d,bk as S,aZ as E,a_ as F,al as H,h as K,n as $}from"./index.0e664210.js";import{u as M}from"./useT.ba77a9ec.js";import{a as N}from"./useTitle.0a4507ea.js";const P=()=>{const t=I("#f1f3f5","#666666");return e(R,{get bgColor(){return t()},pos:"fixed",top:"0",left:"0",overflow:"hidden",zIndex:"-1",w:"100vw",h:"100vh"})},A=()=>{const t=M();N(()=>t("login.title"));const b=I("white","$neutral1"),[o,p]=n(localStorage.getItem("username")||""),[a,m]=n(localStorage.getItem("password")||""),[h,f]=n(""),[s,k]=z("remember-pwd","false"),[v,x]=B(()=>L.post("/auth/login",{username:o(),password:a(),otp_code:h()})),{searchParams:w,to:C}=j(),l=async()=>{s()==="true"?(localStorage.setItem("username",o()),localStorage.setItem("password",a())):(localStorage.removeItem("username"),localStorage.removeItem("password"));const r=await x();K(r,c=>{$.success(t("login.success")),S(c.token),C(decodeURIComponent(w.redirect||"/"),!0)},(c,T)=>{!u()&&T===402?y(!0):$.error(c)})},[u,y]=n(!1);return e(H,{zIndex:"1",w:"$full",h:"100vh",get children(){return[e(O,{get bgColor(){return b()},rounded:"$xl",p:"24px",w:{"@initial":"90%","@sm":"364px"},spacing:"$4",get children(){return[e(i,{alignItems:"center",justifyContent:"space-around",get children(){return e(U,{color:"$info9",fontSize:"$2xl",get children(){return t("login.title")}})}}),e(W,{get when(){return!u()},get fallback(){return e(g,{id:"totp",name:"otp",get placeholder(){return t("login.otp-tips")},get value(){return h()},onChange:r=>f(r.currentTarget.value),onKeyDown:r=>{r.key==="Enter"&&l()}})},get children(){return[e(g,{name:"username",get placeholder(){return t("login.username-tips")},get value(){return o()},onInput:r=>p(r.currentTarget.value)}),e(g,{name:"password",get placeholder(){return t("login.password-tips")},type:"password",get value(){return a()},onInput:r=>m(r.currentTarget.value),onKeyDown:r=>{r.key==="Enter"&&l()}}),e(i,{px:"$1",w:"$full",fontSize:"$sm",color:"$neutral10",justifyContent:"space-between",alignItems:"center",get children(){return e(_,{get checked(){return s()==="true"},onChange:()=>k(s()==="true"?"false":"true"),get children(){return t("login.remember")}})}})]}}),e(D,{w:"$full",spacing:"$2",get children(){return[e(d,{colorScheme:"primary",w:"$full",onClick:()=>{u()?f(""):(p(""),m(""))},get children(){return t("login.clear")}}),e(d,{w:"$full",get loading(){return v()},onClick:l,get children(){return t("login.login")}})]}}),e(d,{w:"$full",colorScheme:"accent",onClick:()=>{S(),C(decodeURIComponent(w.redirect||"/"),!0)},get children(){return t("login.use_guest")}}),e(i,{mt:"$2",justifyContent:"space-evenly",alignItems:"center",color:"$neutral10",w:"$full",get children(){return[e(E,{}),e(F,{})]}})]}}),e(P,{})]}})};export{A as default};
