import{a as A,aO as P,_ as F,bm as j,b as C,Y as _,p as G,bn as l,$ as u,bo as O,bp as L,n as U,ap as S}from"./index.640e0b2c.js";import{l as B,f as D}from"./api.c556522b.js";const E=(t,...r)=>{},m=new Map,Q=(t,r)=>{m.set(t,r)},I=t=>{window.scroll({top:m.get(t)||0,behavior:"smooth"}),E("recoverScroll",t,m.get(t))};let p;function T(t,r,n="replaceState"){let a=n==="location"?location.href:location.hash;if(!a.includes("?"))a=`${a}?${t}=${r}`;else if(!a.includes(t))a=`${a}&${t}=${r}`;else{const f=`(\\?|&|#)${t}([^&|^#]*)(&|$|#)`;a=a.replace(new RegExp(f),"$1"+t+"="+r+"$3")}n==="location"&&(location.href=a),n==="pushState"&&history.pushState({},"",a),n==="replaceState"&&history.replaceState({},"",a)}function $(t){for(var r=window.location.search.substring(1),n=r.split("&"),a=0;a<n.length;a++){var f=n[a].split("=");if(f[0]==t)return f[1]}return""}const b={};let i=1;const W=()=>i,q=()=>{const t=j();i=1,t.type==="pagination"&&T("page",1),console.log("resetGlobalPage",i)},J=()=>{const{pathname:t}=A(),[,r]=P(e=>B(e,F())),n=j();n.type==="pagination"&&$("page")&&(i=parseInt($("page")));const[,a]=P(e=>{const o={index:e==null?void 0:e.index,size:e==null?void 0:e.size};return D(e==null?void 0:e.path,F(),o.index,o.size,e==null?void 0:e.force,new C.CancelToken(function(c){p=c}))}),f=(e,o=!0,s=!1)=>{s&&(e=G(t(),e)),o?b[e]=!0:delete b[e]};let w=!1;const g=(e,o,s)=>{p==null||p(),w=o!=null?o:!1,v(""),b[e]?d(e,i,void 0,void 0,s):z(e)},z=async e=>{l.setState(u.FetchingObj);const o=await r(e);O(o,s=>{var c;l.setObj(s),l.setProvider(s.provider),s.is_dir?(f(e),d(e,i)):(l.setReadme(s.readme),l.setRelated((c=s.related)!=null?c:[]),l.setRawUrl(s.raw_url),l.setState(u.File))},v)},d=async(e,o,s,c=!1,H)=>{s||(s=n.size),s!==void 0&&n.type==="all"&&(s=void 0),i=o!=null?o:1,l.setState(c?u.FetchingMore:u.FetchingObjs);const y=await a({path:e,index:o,size:s,force:H});O(y,h=>{var M;c?L(h.content):(l.setObjs((M=h.content)!=null?M:[]),l.setTotal(h.total)),l.setReadme(h.readme),l.setWrite(h.write),l.setProvider(h.provider),l.setState(u.Folder),c&&(o!=null?o:1)>1||I(e)},v)},v=(e,o)=>{o===403?(l.setState(u.NeedPassword),w&&U.error(e)):l.setErr(e)},R=(e,o,s=!1)=>{d(t(),e,o,s)};return{handlePathChange:g,setPathAs:f,refresh:(e,o)=>{g(t(),e,o)},pageChange:R,loadMore:()=>{R(i+1,void 0,!0)},allLoaded:()=>i>=Math.ceil(_.total/n.size)}};function Y(t){return S({a:{viewBox:"0 0 24 24"},c:'<path fill="none" d="M0 0h24v24H0z"/><path d="M16 2l5 5v14.008a.993.993 0 01-.993.992H3.993A1 1 0 013 21.008V2.992C3 2.444 3.445 2 3.993 2H16zm-3 10h3l-4-4-4 4h3v4h2v-4z"/>'},t)}function x(t){return S({a:{viewBox:"0 0 24 24"},c:'<path fill="none" d="M0 0h24v24H0z"/><path d="M12.414 5H21a1 1 0 011 1v14a1 1 0 01-1 1H3a1 1 0 01-1-1V4a1 1 0 011-1h7.414l2 2zM13 13h3l-4-4-4 4h3v4h2v-4z"/>'},t)}function K(t){return S({a:{viewBox:"0 0 24 24"},c:'<path fill="none" d="M0 0h24v24H0z"/><path d="M5.463 4.433A9.961 9.961 0 0112 2c5.523 0 10 4.477 10 10 0 2.136-.67 4.116-1.81 5.74L17 12h3A8 8 0 006.46 6.228l-.997-1.795zm13.074 15.134A9.961 9.961 0 0112 22C6.477 22 2 17.523 2 12c0-2.136.67-4.116 1.81-5.74L7 12H4a8 8 0 0013.54 5.772l.997 1.795z"/>'},t)}export{K as R,q as a,I as b,x as c,Y as d,T as e,W as g,Q as r,J as u};
